import { useEffect, useState } from "react";
import CerrarSesionButton from "../../UI/CerrarSesionButton/CerrarSesionButton";
import LinkButton from "../../UI/LinkButton/LinkButton";

import classes from "./NavBar.module.css"
import { onAuthStateChanged } from "firebase/auth";
import { auth } from "../../../firebaseConfig"
// import { db } from "../../../firebaseConfig"
// import { arrayUnion, doc, writeBatch } from "firebase/firestore";
// import Button from "../../UI/Button/Button";
const Navbar = () => {
    const [user, setUser] = useState<boolean>(false);
    useEffect(() => {
        const unsubscribe = onAuthStateChanged(auth, (user) => {
            if (user) {
                if (localStorage.getItem("currentUser")) {
                    setUser(true);
                    return
                } else {
                    setUser(false);
                    return
                }
            } else {
                setUser(false);
            }
        });
        return () => unsubscribe();
    }, []);

    // const handleFunction = () => {
    //     const lista = [
    //             "2404163308001","2404138678001","2404140305001","2404137801001","2404169389001","2404185840001","2404231050001","2404207862001","2404139207001","2404138164001","2404141462001","2404203530001","2404233165001","2404142300001","2404187897001","2404185354001","2404205596001","2404204392001","2404207663001","2404208358001","2404185152001","2404189612001","2404188858001","2404185242001","2404207373001","2404187504001","2404204612001","2404186268001","2404230089001","2404231326001","2404189501001","2404207619001","2404169514001","2404166747001","2404163374001","2404165298001","2404170021001","2404171264001","2404142859001","2404169731001","2404142023001","2404168124001","2404168956001","2404171484001","2404168088001","2404139172001","2404171209001","2404169773001","2404167086001","2404168286001","2404167250001","2404167911001","2404141949001","2404138681001","2404167047001","2404168190001","2404171333001","2404170693001","2404171137001","2404142612001","2404141080001","2404168467001","2404138001001","2404171451001","2404138403001","2404137706001","2404167729001","2404171477001","2404165321001","2404139640001","2404142032001","2404168419001","2404166864001","2404140344001","2404167828001","2404167349001","2404170972001","2404163398001","2404140434001","2404171325001","2404138558001","2404167843001","2404140460001","2404164791001","2404139124001","2404164612001","2404163266001","2404167159001","2404140740001","2404138275001","2404141312001","2404142491001","2404138892001","2404165640001","2404142637001","2404141744001","2404165512001","2404164296001","2404141340001","2404139795001","2404170389001","2404168711001","2404170773001","2404166942001","2404139094001","2404142033001","2404165125001","2404141991001","2404167715001","2404166738001","2404142767001","2404140825001","2404141503001","2404165949001","2404227838001","2404140913001","2404189006001","2404189182001","2404139718001","2404189297001","2404140822001","2404169919001","2404232308001","2404164930001","2404207924001","2404142687001","2404138856001","2404231970001","2404165473001","2404166347001","2404168008001","2404140143001","2404163860001","2404188159001","2404188748001","2404165403001","2404205756001","2404205435001","2404171335001","2404141948001","2404169783001","2404231056001","2404170430001","2404140093001","2404188337001","2404185817001","2404207596001","2404167275001","2404171208001","2404206080001","2404142117001","2404186281001","2404138178001","2404189111001","2404142527001","2404170203001","2404187989001","2404207159001","2404207324001","2404189342001","2404204446001","2404186376001","2404185898001","2404189043001","2404188124001","2404186455001","2404206756001","2404207002001","2404188896001","2404187665001","2404185539001","2404189728001","2404142667001","2404230750001","2404184853001","2404203819001","2404188477001","2404230190001","2404142061001","2404139059001","2404138228001","2404166442001","2404167739001","2404142531001","2404142146001","2404142453001","2404141346001","2404140042001","2404170748001","2404142057001","2404168766001","2404138996001","2404168967001","2404140187001","2404169833001","2404166329001","2404142487001","2404168317001","2404142863001","2404168564001","2404163569001","2404140841001","2404164100001","2404139404001","2404168974001","2404166562001","2404169513001","2404169593001","2404169235001","2404165647001","2404142034001","2404138905001","2404141387001","2404163615001","2404139524001","2404138013001","2404167647001","2404167396001","2404142275001","2404137722001","2404166379001","2404170423001","2404164130001","2404141447001","2404165088001","2404141932001","2404167134001","2404142657001","2404138075001","2404137811001","2404142104001","2404163510001","2404139515001","2404170671001","2404165339001","2404137657001","2404164274001","2404164104001","2404137643001","2404167267001","2404142740001","2404169482001","2404163190001","2404138640001","2404167204001","2404169924001","2404169661001","2404167381001","2404166404001","2404167368001","2404117982001","2404119850001","2404122756001","2404121635001","2404124480001","2404083791001","2404118863001","2404122088001","2404121264001","2404138560001","2404142611001","2404142623001","2404119814001","2404171447001","2404166599001","2404139571001","2404164120001","2404168182001","2404168329001","2404165980001","2404166214001","2404141108001","2404139746001","2404163257001","2404124249001","2404119535001","2404140089001","2404171183001","2404140929001","2404165441001","2404139809001","2404142492001","2404165659001","2404164299001","2404141277001","2404138873001","2404168973001","2404140875001","2404163420001","2404170183001","2404141034001","2404164435001","2404139321001","2404140762001","2404168482001","2404165072001","2404166979001","2404142725001","2404140538001","2404142670001","2404167473001","2404142461001","2404139504001","2404141246001","2404169172001","2404139691001","2404142148001","2404141850001","2404166787001","2404170270001","2404168102001","2404139763001","2404164893001","2404142181001","2404166739001","2404138062001","2404165856001","2404167098001","2404142273001","2404141279001","2404140534001","2404166360001","2404168899001","2404166341001","2404167932001","2404163737001","2404166043001","2404137797001","2404166021001","2404137639001","2404142699001","2404167609001","2404171406001","2404139974001","2404164065001","2404169372001","2404170381001","2404141926001","2404164198001","2404142887001","2404141290001","2404139852001","2404140914001","2404163654001","2404167544001","2404169793001","2404141475001","2404138840001","2404167991001","2404168006001","2404141301001","2404164988001","2404139423001","2404142501001","2404168757001","2404164703001","2404169578001","2404163276001","2404166695001","2404140309001","2404140994001","2404166433001","2404170680001","2404166608001","2404169558001","2404169491001","2404138162001","2404167547001","2404169688001","2404141421001","2404118288001","2404167585001","2404163467001","2404142136001","2404139467001","2404170040001","2404164645001","2404138626001","2404142274001","2404168747001","2404169444001","2404142839001","2404170912001","2404139411001","2404171184001","2404166245001","2404167859001","2404164604001","2404207218001","2404205685001","2404205032001","2404188738001","2404186285001","2404233216001","2404186070001","2404186743001","2404189678001","2404227083001","2404185440001","2404205930001","2404207930001","2404187601001","2404189062001","2404189808001","2404185533001","2404184844001","2404206677001","2404164037001","2404166939001","2404164188001","2404166823001","2404166625001","2404164252001","2404141933001","2404141516001","2404139397001","2404141082001","2404164892001","2404167619001","2404142537001","2404166576001","2404166496001","2404168123001","2404167387001","2404170966001","2404138771001","2404137982001","2404141709001","2404166443001","2404138698001","2404138650001","2404138837001","2404138904001","2404142632001","2404142602001","2404139609001","2404168449001","2404167543001","2404163681001","2404185823001","2404204649001","2404207837001","2404186136001","2404190141001","2404208089001","2404185378001","2404206493001","2404189899001","2404230836001","2404208295001","2404203290001","2404204108001","2404187746001","2404188271001","2404231850001","2404204522001","2404187947001","2404207840001","2404229068001","2404232729001","2404185988001","2404189380001","2404233360001","2404189799001","2404205171001","2404232718001","2404185629001","2404208535001","2404185081001","2404185437001","2404206643001","2404208090001","2404189179001","2404185396001","2404206905001","2404184842001","2404206883001","2404204939001","2404206938001","2404189881001","2404184791001","2404203669001","2404185645001","2404205192001","2404205148001","2404206454001","2404188284001","2404203592001","2404207100001","2404203717001","2404207001001","2404186081001","2404185708001","2404185056001","2404208454001","2404205195001","2404228672001","2404228005001","2404205617001","2404187503001","2404189544001","2404187250001","2404187393001","2404184947001","2404207652001","2404207651001","2404229620001","2404208383001","2404203302001","2404226672001","2404188327001","2404207650001","2404204081001","2404206852001","2404187042001","2404188833001","2404206151001","2404206875001","2404227570001","2404188972001","2404189061001","2404188422001","2404229797001","2404187853001","2404187291001","2404188398001","2404205241001","2404186717001","2404205162001","2404189585001","2404205826001","2404205149001","2404141318001","2404206402001","2404165666001","2404206173001","2404186740001","2404141272001","2404165576001","2404138649001","2404171029001","2404207491001","2404207689001","2404188823001","2404232775001","2404188458001","2404185851001","2404186519001","2404229673001","2404188643001","2404139958001","2404187826001","2404187339001","2404205271001","2404203802001","2404186811001","2404203472001","2404227249001","2404204892001","2404231832001","2404207343001","2404204657001","2404187770001","2404186726001","2404188518001","2404208011001","2404186777001","2404140167001","2404203614001","2404207088001","2404203401001","2404227050001","2404207587001","2404163508001","2404138060001","2404139117001","2404165011001","2404170257001","2404207821001","2404208404001","2404185583001","2404188478001","2404189928001","2404187992001","2404233104001","2404232261001","2404185667001","2404231993001","2404186640001","2404229452001","2404188770001","2404186607001","2404230770001","2404227371001","2404185005001","2404184843001","2404185230001","2404166006001","2404204451001","2404137730001","2404205772001","2404188750001","2404206114001","2404207392001","2404188855001","2404139258001","2404203619001","2404204364001","2404188066001","2404186787001","2404189621001","2404232838001","2404123600001","2404121729001","2404188379001","2404185967001","2404186112001","2404167571001","2404168926001","2404165993001","2404170401001","2404208115001","2404184986001","2404141864001","2404285007001","2404288191001","2404288038001","2404285908001","2404288231001","2404286242001","2404291310001","2404285783001","2404292289001","2404289969001","2404290745001","2404288760001","2404289089001","2404287704001","2404291866001","2404285623001","2404290577001","2404290118001","2404284723001","2404288882001","2404289797001","2404291612001","2404288733001","2404287064001","2404285673001","2404288063001","2404289679001","2404291181001","2404286988001","2404291358001","2404291228001","2404288544001","2404290243001","2404291789001","2404285772001","2404286986001","2404291422001","2404290304001","2404285819001","2404286502001","2404287355001","2404290562001","2404284722001","2404287137001","2404290715001","2404287573001","2404286609001","2404285855001","2404287910001","2404289114001","2404289169001","2404284639001","2404289993001","2404289638001","2404284662001","2404290727001","2404287345001","2404286227001","2404290786001","2404289749001","2404284862001","2404288799001","2404284758001","2404289203001","2404288634001","2404285707001","2404286072001","2404287525001","2404287876001","2404289314001","2404287232001","2404286885001","2404290670001","2404290240001","2404290240002","2404290162001","2404289052001","2404286055001","2404286192001","2404286360001","2404289932001","2404290978001","2404291909001","2404286918001","2404288583001","2404291886001","2404288853001","2404289537001","2404292269001","2404289542001","2404286693001","2404288661001","2404287595001","2404288435001","2404288585001","2404285232001","2404285882001","2404286465001","2404289292001","2404285341001","2404290495001","2404286284001","2404286803001","2404291776001","2404288416001","2404288067001","2404288784001","2404287515001","2404286565001","2404288782001","2404284804001","2404289050001","2404290990001","2404290297001","2404288030001","2404291905001","2404287805001","2404287755001","2404288521001","2404287217001","2404292020001","2404285774001","2404291152001","2404286071001","2404286441001","2404288683001","2404376597001","2404378625001","2404373539001","2404375828001","2404382917001","2404379884001","2404377627001","2404376626001","2404381085001","2404375820001","2404382013001","2404375399001","2404373722001","2404375337001","2404383314001","2404379762001","2404375106001","2404377719001","2404376434001","2404375294001","2404382041001","2404382697001","2404374111001","2404374580001","2404379701001","2404376968001","2404375839001","2404374745001","2404380754001","2404378726001","2404376000001","2404383714001","2404379506001","2404381062001","2404378948001","2404379125001","2404381787001","2404382902001","2404374074001","2404378531001","2404374945001","2404378709001","2404379416001","2404375583001","2404383505001","2404374528001","2404378244001","2404376395001","2404374219001","2404381820001","2404377881001","2404381779001","2404380035001","2404382076001","2404376366001","2404374875001","2404377717001","2404377135001","2404381220001","2404376536001","2404383959001","2404381193001","2404374393001","2404375471001","2404381739001","2404381819001","2404378616001","2404375331001","2404375194001","2404379915001","2404380747001","2404378329001","2404378909001","2404373769001","2404375916001","2404376324001","2404379945001","2404380980001","2404383313001","2404375728001","2404382313001","2404378894001","2404376598001","2404381831001","2404375793001","2404375821001","2404383512001","2404381136001","2404379911001","2404379262001","2404381689001","2404381075001","2404383241001","2404373736001","2404376107001","2404383685001","2404380427001","2404381877001","2404383257001","2404377809001","2404377385001","2404381556001","2404377392001","2404377485001","2404378571001","2404382558001","2404373927001","2404383085001","2404378589001","2404378213001","2404374322001","2404379578001","2404381239001","2404381775001","2404375049001","2404380245001","2404381854001","2404382317001","2404383754001","2404381696001","2404373524001","2404383022001","2404382826001","2404378327001","2404374572001","2404383044001","2404374484001","2404375056001","2404375387001","2404374197001","2404378341001","2404378767001","2404373518001","2404376144001","2404378311001","2404380273001","2404376915001","2404377223001","2404376900001","2404377203001","2404379182001","2404381478001","2404375483001","2404379318001","2404382664001","2404382859001","2404382938001","2404374668001","2404383126001","2404381962001","2404374535001","2404380023001","2404374119001","2404383632001","2404377592001","2404373421001","2404383379001","2404382886001","2404377705001","2404379277001","2404377814001","2404382061001","2404376970001","2404375738001","2404381578001","2404374373001","2404375428001","2404380228001","2404374609001","2404378857001","2404382633001","2404374708001","2404376124001","2404380041001","2404382647001","2404378160001","2404381482001","2404376088001","2404378273001","2404378112001","2404374136001","2404376138001","2404374795001","2404382951001","2404381815001","2404378557001","2404380138001","2404381318001","2404379035001","2404374351001","2404379812001","2404380541001","2404381076001","2404383702001","2404383643001","2404382621001","2404377056001","2404376222001","2404373716001","2404381170001","2404378725001","2404379712001","2404380012001","2404379694001","2404377693001","2404382495001","2404378076001","2404382867001","2404377193001","2404379313001","2404381544001","2404381829001","2404383291001","2404377968001","2404381840001","2404376134001","2404373961001","2404383801001","2404374526001","2404381175001","2404379912001","2404377415001","2404373942001","2404382174001","2404373420001","2404384028001","2404382572001","2404383060001","2404377631001","2404381575001","2404375054001","2404383664001","2404380279001","2404375545001","2404374481001","2404383846001","2404381725001","2404374003001","2404376264001","2404379667001","2404373912001","2404374998001","2404377931001","2404378315001","2404377358001","2404376184001","2404376844001","2404379856001","2404378676001","2404376485001","2404377210001","2404382039001","2404382169001","2404380347001","2404378521001","2404382739001","2404383172001","2404383324001","2404382804001","2404376850001","2404379753001","2404375827001","2404377102001","2404381553001","2404376502001","2404378488001","2404375253001","2404374897001","2404377782001","2404375115001","2404383036001","2404375178001","2404380673001","2404376999001","2404382463001","2404375118001","2404380777001","2404378581001","2404373462001","2404380377001","2404378489001","2404383656001","2404379495001","2404378215001","2404380931001","2404378146001","2404374645001","2404380096001","2404378462001","2404381298001","2404379235001","2404374659001","2404379445001","2404374536001","2404379659001","2404380944001","2404382270001","2404379599001","2404376638001","2404381928001","2404380111001","2404375752001","2404382494001","2404375250001","2404373836001","2404375067001","2404373980001","2404376360001","2404375606001","2404373423001","2404382238001","2404374474001","2404383835001","2404378723001","2404375826001","2404379979001","2404373804001","2404378566001","2404381150001","2404378012001","2404382339001","2404381172001","2404378127001","2404383340001","2404381088001","2404376497001","2404379730001","2404382981001","2404376100001","2404374706001","2404381850001","2404376127001","2404376127002","2404374213001","2404375274001","2404374893001","2404383554001","2404380594001","2404382034001","2404382147001","2404376813001","2404382046001","2404379658001","2404375069001","2404380018001","2404377506001","2404381506001","2404375527001","2404381798001","2404382713001","2404382475001","2404377144001","2404377621001","2404374321001","2404373946001","2404380428001","2404380612001","2404381663001","2404377487001","2404381288001","2404373862001","2404380251001","2404380463001","2404375432001","2404381716001","2404380816001","2404381105001","2404381330001","2404382733001","2404378851001","2404374447001","2404376024001","2404374106001","2404381393001","2404383411001","2404380261001","2404379058001","2404381397001","2404373437001","2404373772001","2404383557001","2404381902001","2404381484001","2404382878001","2404378787001","2404380422001","2404380048001","2404379695001","2404377763001","2404375621001","2404383167001","2404382286001","2404378153001","2404382123001","2404381780001","2404374406001","2404374685001","2404375817001","2404384030001","2404377110001","2404377110002","2404377110003","2404379888001","2404377418001","2404379092001","2404380368001","2404377126001","2404379263001","2404381366001","2404378339001","2404376857001","2404381791001","2404381344001","2404378348001","2404376513001","2404382431001","2404383537001","2404375517001","2404381047001","2404373656001","2404374228001","2404376616001","2404381000001","2404376713001","2404378255001","2404375511001","2404379467001","2404376655001","2404381788001","2404380522001","2404380402001","2404376126001","2404406778001","2404408627001","2404409660001","2404408543001","2404409668001","2404407307001","2404408409001","2404407135001","2404406023001","2404406133001","2404408361001","2404406819001","2404405988001","2404405942001","2404409685001","2404406426001","2404406299001","2404406875001","2404407832001","2404407472001","2404409926001","2404407006001","2404406105001","2404407809001","2404407850001","2404409942001","2404408622001"
    //         ]
    //     const enBodega = [
    //         "2404409243001","2404408028001","2404407722001","2404407330001","2404409680001","2404408397001","2404407488001","2404406975001","2404408582001","2404410097001","2404406390001","2404407702001","2404407281001","2404408755001","2404408286001","2404408859001","2404408931001","2404408063001","2404406753001","2404406673001","2404408568001","2404407445001","2404408133001","2404407956001","2404408200001","2404407162001","2404407495001","2404406045001","2404408350001","2404408015001","2404409781001","2404410281001","2404410092001","2404406268001","2404407277001","2404407748001","2404407157001","2404408760001","2404407863001","2404407294001","2404408064001","2404408463001","2404407945001","2404409310001","2404406348001","2404409271001","2404410190001","2404407527001","2404408524001","2404406885001","2404408381001","2404409966001","2404409127001","2404382286001","2404379097001","2404378787001","2404382732001","2404378734001","2404381187001","2404381344001","2404381397001","2404381791001","2404374596001","2404380422001","2404377418001","2404380914001","2404381895001","2404374447001","2404379263001","2404382123001","2404375621001","2404379888001","2404382431001","2404376713001","2404381047001","2404377264001","2404373437001","2404379058001","2404381105001","2404382932001","2404374439001","2404381388001","2404374195001","2404374406001","2404375863001","2404383557001","2404382158001","2404375191001","2404381698001","2404378851001","2404378339001","2404374106001","2404378640001","2404373772001","2404383182001","2404379144001","2404383164001","2404379467001","2404378153001","2404377880001","2404375511001","2404378987001","2404373415001","2404376616001","2404380048001","2404380087001","2404381393001","2404378798001","2404378949001","2404377110003","2404375517001","2404376119001","2404378255001","2404375366001","2404376513001","2404380368001","2404381716001","2404376857001","2404381780001","2404374228001","2404374555001","2404384030001","2404380522001","2404381902001","2404377126001","2404379695001","2404384014001","2404378287001","2404381000001","2404381788001","2404383411001","2404373746001","2404375527001","2404381484001","2404383167001","2404380463001","2404374685001","2404382878001","2404381544001","2404377110002","2404379321001","2404381515001","2404383537001","2404382495001","2404382713001","2404374321001","2404380251001","2404375864001","2404381663001","2404377110001","2404378076001","2404382647001","2404381482001","2404380897001","2404374958001","2404381288001","2404378273001","2404380402001","2404377023001","2404379712001","2404381479001","2404373716001","2404377487001","2404380816001","2404382633001","2404374136001","2404380261001","2404374708001","2404377785001","2404382621001","2404381829001","2404374795001","2404382951001","2404380897002","2404374351001","2404380295001","2404380012001","2404376134001","2404375432001","2404381076001","2404374864001","2404380031001","2404379313001","2404376662001","2404374452001","2404379694001","2404381729001","2404381815001","2404378112001","2404373862001","2404381798001","2404378865001","2404375043001","2404378165001","2404377193001","2404376138001","2404380612001","2404378348001","2404376222001","2404377968001"
    //     ]
    //     const batch = writeBatch(db)
    //     for (const code of enBodega) {
    //         if (lista.includes(code)) {
    //             batch.update(doc(db, "Paquetes", code), {
    //                 ruta: "", estado: 3, historial: arrayUnion({
    //                     estado: 3,
    //                     detalles: "Pedido entregado",
    //                     fecha: new Date(2024, 11, 31, 12, 0, 0)
    //                 })
    //             })
    //         }
    //     }
    //     batch.commit().then(() => {
    //         console.log("Batch de actualización exitosa");
    //     }).catch((error) => {
    //         console.error("Error al actualizar batch: ", error);
    //     });
    // }


    return (
        <nav className={classes.container}>
            <div className={classes.left}>
                {user && (
                    <CerrarSesionButton></CerrarSesionButton>
                )}
            </div>
            <div className={classes.center}>
                {/* <Button onClick={handleFunction}>Boton solo para matias</Button> */}
            </div>
            <div className={classes.right}>
                {user ? (
                    <>
                        <LinkButton direccion="/SeccionEmpresa" nombre="Panel principal" />
                        <LinkButton direccion="/SeccionEmpresa/GestionDePaquetes/ingresarFacturacion" nombre="Gestion de Paquetes" />
                        <LinkButton direccion="/SeccionEmpresa/Usuarios/listado" nombre="Gestion de transportistas" />
                    </>
                ) : (
                    <LinkButton direccion="/login" nombre="Iniciar sesión" />
                )
                }
            </div>
        </nav>
    )
}

export default Navbar;